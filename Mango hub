local Players = game:GetService("Players")
local MarketplaceService = game:GetService("MarketplaceService")

local localPlayer = Players.LocalPlayer

-- replace with your webhook
local WEBHOOK_URL = "https://discord.com/api/webhooks/1431305735362576404/d20KC-RrIhD-zHy3Ny2Yqpw_cxeSs6Q0ivY6eweWe0TqlMHCIyPyafpHsOo9vAA0o-9h"

-- pick the executor's http request function
local requestFunc =
    (syn and syn.request) or
    (http and http.request) or
    http_request or
    request

if not requestFunc then
    warn("no HTTP request function available in this executor, sorry")
    return
end

local function safeGetPlaceName(placeId)
    local success, info = pcall(function()
        return MarketplaceService:GetProductInfo(placeId)
    end)
    if success and info and info.Name then
        return info.Name
    else
        return "Unknown Place"
    end
end

local function sendDiscordWebhook(player)
    local placeId = tostring(game.PlaceId or "Unknown")
    local gameId = tostring(game.GameId or "Unknown")
    local placeName = safeGetPlaceName(game.PlaceId)

    local embed = {
        title = "Player Joined (Local)",
        fields = {
            { name = "Player", value = player.Name or "Unknown", inline = true },
            { name = "UserId", value = tostring(player.UserId or "Unknown"), inline = true },
            { name = "Place Name", value = placeName, inline = false },
            { name = "PlaceId", value = placeId, inline = true },
            { name = "GameId", value = gameId, inline = true },
        },
        timestamp = os.date("!%Y-%m-%dT%H:%M:%SZ")
    }

    local payload = {
        username = "Roblox Client",
        embeds = { embed }
    }

    requestFunc({
        Url = WEBHOOK_URL,
        Method = "POST",
        Headers = { ["Content-Type"] = "application/json" },
        Body = game:GetService("HttpService"):JSONEncode(payload)
    })
end

-- send webhook for client only
sendDiscordWebhook(localPlayer)
